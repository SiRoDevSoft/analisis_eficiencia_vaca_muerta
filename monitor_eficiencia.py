{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "7d9385dc-1fea-43de-9fc2-ef4c3a8645f3",
   "metadata": {},
   "source": [
    "# MONITOR DE EFICIENCIA\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "cb8191d2-b5bc-4861-bdae-2a239e9664c7",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "\n",
    "# Generamos 100 pozos de la Cuenca Neuquina\n",
    "np.random.seed(42)\n",
    "n_pozos = 100\n",
    "\n",
    "data = {\n",
    "    'pozo_id': [f'AN-X{i:03}' for i in range(1, n_pozos + 1)],\n",
    "    'prod_teorica_bpd': np.random.uniform(200, 1000, n_pozos), # Barriles por día\n",
    "    'prod_real_bpd': np.random.uniform(150, 950, n_pozos),\n",
    "    'presion_psi': np.random.uniform(300, 600, n_pozos),\n",
    "    'temp_c': np.random.uniform(60, 90, n_pozos)\n",
    "}\n",
    "\n",
    "df = pd.DataFrame(data)\n",
    "\n",
    "# Simulamos que algunos pozos tienen una falla crítica (Producción Real muy baja)\n",
    "df.loc[df.sample(5).index, 'prod_real_bpd'] *= 0.3"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "870922f3-9e94-4575-83d1-0f8c664d6be9",
   "metadata": {},
   "source": [
    "### Eficiencia de Producción."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d435ccb1-05df-43e2-a839-8fece487c65c",
   "metadata": {},
   "source": [
    "La Fórmula:\n",
    "$Eficiencia (\\%) = \\left( \\frac{Producción Real}{Producción Teórica} \\right) \\times 100$"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5c1a3f00-75f1-4757-b5e1-662c94af116b",
   "metadata": {},
   "source": [
    "#### Objetivo\n",
    "\n",
    "1. Crear una nueva columna en el DataFrame llamada **eficiencia**.\n",
    "\n",
    "2. Identificar los pozos cuya eficiencia sea menor al 70% (esto en el campo es una alerta roja).\n",
    "\n",
    "3. Guardá esos pozos críticos en una variable nueva llamada *\"prioridad_intervencion\"*.\n",
    "\n",
    "**Analista Rojas**: ¿Cómo viene esa carga de datos? Pasame el código de cómo calculaste esa eficiencia y decime cuántos pozos detectaste que necesitan que mandemos la camioneta urgente.\n",
    "\n",
    "**Recordá**: Estamos trabajando volumen, así que usá las funciones de *pandas* para hacerlo de un solo golpe, nada de bucles for lentos. ¡Te leo!"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "3f0d71e3-0d18-4ba3-9e9b-7133cc6e7109",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>pozo_id</th>\n",
       "      <th>prod_teorica_bpd</th>\n",
       "      <th>prod_real_bpd</th>\n",
       "      <th>presion_psi</th>\n",
       "      <th>temp_c</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>AN-X001</td>\n",
       "      <td>499.632095</td>\n",
       "      <td>175.143349</td>\n",
       "      <td>492.609494</td>\n",
       "      <td>61.550452</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>AN-X002</td>\n",
       "      <td>960.571445</td>\n",
       "      <td>659.128329</td>\n",
       "      <td>325.241989</td>\n",
       "      <td>75.940639</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>AN-X003</td>\n",
       "      <td>785.595153</td>\n",
       "      <td>401.484785</td>\n",
       "      <td>348.488614</td>\n",
       "      <td>76.219054</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>AN-X004</td>\n",
       "      <td>678.926787</td>\n",
       "      <td>556.856553</td>\n",
       "      <td>569.566257</td>\n",
       "      <td>79.122897</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>AN-X005</td>\n",
       "      <td>324.814912</td>\n",
       "      <td>876.053179</td>\n",
       "      <td>481.928718</td>\n",
       "      <td>81.782740</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   pozo_id  prod_teorica_bpd  prod_real_bpd  presion_psi     temp_c\n",
       "0  AN-X001        499.632095     175.143349   492.609494  61.550452\n",
       "1  AN-X002        960.571445     659.128329   325.241989  75.940639\n",
       "2  AN-X003        785.595153     401.484785   348.488614  76.219054\n",
       "3  AN-X004        678.926787     556.856553   569.566257  79.122897\n",
       "4  AN-X005        324.814912     876.053179   481.928718  81.782740"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "abecc427-cae8-414b-8805-a2a96836aa60",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>pozo_id</th>\n",
       "      <th>prod_teorica_bpd</th>\n",
       "      <th>prod_real_bpd</th>\n",
       "      <th>presion_psi</th>\n",
       "      <th>temp_c</th>\n",
       "      <th>eficiencia</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>AN-X001</td>\n",
       "      <td>499.632095</td>\n",
       "      <td>175.143349</td>\n",
       "      <td>492.609494</td>\n",
       "      <td>61.550452</td>\n",
       "      <td>35.054463</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>AN-X002</td>\n",
       "      <td>960.571445</td>\n",
       "      <td>659.128329</td>\n",
       "      <td>325.241989</td>\n",
       "      <td>75.940639</td>\n",
       "      <td>68.618355</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>AN-X003</td>\n",
       "      <td>785.595153</td>\n",
       "      <td>401.484785</td>\n",
       "      <td>348.488614</td>\n",
       "      <td>76.219054</td>\n",
       "      <td>51.105812</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>AN-X009</td>\n",
       "      <td>680.892009</td>\n",
       "      <td>333.038532</td>\n",
       "      <td>301.518475</td>\n",
       "      <td>83.855586</td>\n",
       "      <td>48.912093</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>AN-X010</td>\n",
       "      <td>766.458062</td>\n",
       "      <td>211.583928</td>\n",
       "      <td>348.242415</td>\n",
       "      <td>68.124968</td>\n",
       "      <td>27.605415</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>AN-X012</td>\n",
       "      <td>975.927882</td>\n",
       "      <td>278.977030</td>\n",
       "      <td>507.568559</td>\n",
       "      <td>62.353691</td>\n",
       "      <td>28.585824</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>AN-X018</td>\n",
       "      <td>619.805145</td>\n",
       "      <td>299.256047</td>\n",
       "      <td>523.947422</td>\n",
       "      <td>65.198830</td>\n",
       "      <td>48.282279</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>AN-X024</td>\n",
       "      <td>493.089475</td>\n",
       "      <td>238.041540</td>\n",
       "      <td>410.314741</td>\n",
       "      <td>68.398017</td>\n",
       "      <td>48.275526</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>AN-X025</td>\n",
       "      <td>564.855987</td>\n",
       "      <td>332.348130</td>\n",
       "      <td>379.560710</td>\n",
       "      <td>88.645958</td>\n",
       "      <td>58.837675</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>AN-X026</td>\n",
       "      <td>828.140769</td>\n",
       "      <td>491.686231</td>\n",
       "      <td>373.196893</td>\n",
       "      <td>82.136908</td>\n",
       "      <td>59.372301</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>AN-X029</td>\n",
       "      <td>673.931655</td>\n",
       "      <td>155.561704</td>\n",
       "      <td>567.613967</td>\n",
       "      <td>72.588002</td>\n",
       "      <td>23.082712</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>31</th>\n",
       "      <td>AN-X032</td>\n",
       "      <td>336.419299</td>\n",
       "      <td>98.305875</td>\n",
       "      <td>450.791128</td>\n",
       "      <td>82.735383</td>\n",
       "      <td>29.221235</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>33</th>\n",
       "      <td>AN-X034</td>\n",
       "      <td>959.108430</td>\n",
       "      <td>420.092137</td>\n",
       "      <td>447.755308</td>\n",
       "      <td>63.482179</td>\n",
       "      <td>43.800276</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>35</th>\n",
       "      <td>AN-X036</td>\n",
       "      <td>846.717878</td>\n",
       "      <td>408.562346</td>\n",
       "      <td>516.735635</td>\n",
       "      <td>61.221864</td>\n",
       "      <td>48.252477</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>38</th>\n",
       "      <td>AN-X039</td>\n",
       "      <td>747.386421</td>\n",
       "      <td>440.903682</td>\n",
       "      <td>493.641689</td>\n",
       "      <td>74.225215</td>\n",
       "      <td>58.992734</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>41</th>\n",
       "      <td>AN-X042</td>\n",
       "      <td>596.141528</td>\n",
       "      <td>351.425837</td>\n",
       "      <td>586.178573</td>\n",
       "      <td>74.204153</td>\n",
       "      <td>58.950068</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>43</th>\n",
       "      <td>AN-X044</td>\n",
       "      <td>927.456322</td>\n",
       "      <td>390.702648</td>\n",
       "      <td>411.047610</td>\n",
       "      <td>73.015549</td>\n",
       "      <td>42.126259</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>44</th>\n",
       "      <td>AN-X045</td>\n",
       "      <td>407.023985</td>\n",
       "      <td>113.361719</td>\n",
       "      <td>304.636985</td>\n",
       "      <td>71.955142</td>\n",
       "      <td>27.851361</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>45</th>\n",
       "      <td>AN-X046</td>\n",
       "      <td>730.017827</td>\n",
       "      <td>179.509558</td>\n",
       "      <td>578.495569</td>\n",
       "      <td>78.475503</td>\n",
       "      <td>24.589750</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>48</th>\n",
       "      <td>AN-X049</td>\n",
       "      <td>637.368223</td>\n",
       "      <td>191.183001</td>\n",
       "      <td>589.085993</td>\n",
       "      <td>71.238378</td>\n",
       "      <td>29.995691</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>51</th>\n",
       "      <td>AN-X052</td>\n",
       "      <td>820.106259</td>\n",
       "      <td>341.649513</td>\n",
       "      <td>415.529319</td>\n",
       "      <td>85.694695</td>\n",
       "      <td>41.659176</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>52</th>\n",
       "      <td>AN-X053</td>\n",
       "      <td>951.599153</td>\n",
       "      <td>265.915898</td>\n",
       "      <td>555.341001</td>\n",
       "      <td>79.760809</td>\n",
       "      <td>27.944108</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>53</th>\n",
       "      <td>AN-X054</td>\n",
       "      <td>915.861880</td>\n",
       "      <td>541.562208</td>\n",
       "      <td>395.076602</td>\n",
       "      <td>64.888033</td>\n",
       "      <td>59.131428</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>54</th>\n",
       "      <td>AN-X055</td>\n",
       "      <td>678.319983</td>\n",
       "      <td>281.556109</td>\n",
       "      <td>350.847824</td>\n",
       "      <td>62.117062</td>\n",
       "      <td>41.507860</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>55</th>\n",
       "      <td>AN-X056</td>\n",
       "      <td>937.499388</td>\n",
       "      <td>343.644217</td>\n",
       "      <td>467.040379</td>\n",
       "      <td>79.272578</td>\n",
       "      <td>36.655407</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>64</th>\n",
       "      <td>AN-X065</td>\n",
       "      <td>424.747608</td>\n",
       "      <td>222.231816</td>\n",
       "      <td>563.211922</td>\n",
       "      <td>88.243944</td>\n",
       "      <td>52.320911</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66</th>\n",
       "      <td>AN-X067</td>\n",
       "      <td>312.739380</td>\n",
       "      <td>121.987216</td>\n",
       "      <td>509.104722</td>\n",
       "      <td>88.835717</td>\n",
       "      <td>39.006030</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>67</th>\n",
       "      <td>AN-X068</td>\n",
       "      <td>841.757585</td>\n",
       "      <td>299.214808</td>\n",
       "      <td>510.745225</td>\n",
       "      <td>87.160519</td>\n",
       "      <td>35.546434</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>69</th>\n",
       "      <td>AN-X070</td>\n",
       "      <td>989.509549</td>\n",
       "      <td>622.714355</td>\n",
       "      <td>388.077553</td>\n",
       "      <td>62.080839</td>\n",
       "      <td>62.931616</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>71</th>\n",
       "      <td>AN-X072</td>\n",
       "      <td>358.972545</td>\n",
       "      <td>163.270263</td>\n",
       "      <td>543.034018</td>\n",
       "      <td>60.546655</td>\n",
       "      <td>45.482660</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>73</th>\n",
       "      <td>AN-X074</td>\n",
       "      <td>852.369143</td>\n",
       "      <td>99.358986</td>\n",
       "      <td>573.972166</td>\n",
       "      <td>80.490203</td>\n",
       "      <td>11.656802</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75</th>\n",
       "      <td>AN-X076</td>\n",
       "      <td>783.205734</td>\n",
       "      <td>289.493143</td>\n",
       "      <td>450.454888</td>\n",
       "      <td>69.569269</td>\n",
       "      <td>36.962592</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>80</th>\n",
       "      <td>AN-X081</td>\n",
       "      <td>890.482741</td>\n",
       "      <td>422.853081</td>\n",
       "      <td>567.001603</td>\n",
       "      <td>63.544945</td>\n",
       "      <td>47.485826</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>81</th>\n",
       "      <td>AN-X082</td>\n",
       "      <td>698.638501</td>\n",
       "      <td>240.778817</td>\n",
       "      <td>401.398547</td>\n",
       "      <td>80.902115</td>\n",
       "      <td>34.464006</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>88</th>\n",
       "      <td>AN-X089</td>\n",
       "      <td>909.770194</td>\n",
       "      <td>573.720463</td>\n",
       "      <td>385.962376</td>\n",
       "      <td>82.518443</td>\n",
       "      <td>63.062130</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>89</th>\n",
       "      <td>AN-X090</td>\n",
       "      <td>577.771940</td>\n",
       "      <td>343.481833</td>\n",
       "      <td>477.249978</td>\n",
       "      <td>84.205042</td>\n",
       "      <td>59.449379</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>94</th>\n",
       "      <td>AN-X095</td>\n",
       "      <td>816.773744</td>\n",
       "      <td>421.223833</td>\n",
       "      <td>338.118154</td>\n",
       "      <td>70.224106</td>\n",
       "      <td>51.571667</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    pozo_id  prod_teorica_bpd  prod_real_bpd  presion_psi     temp_c  \\\n",
       "0   AN-X001        499.632095     175.143349   492.609494  61.550452   \n",
       "1   AN-X002        960.571445     659.128329   325.241989  75.940639   \n",
       "2   AN-X003        785.595153     401.484785   348.488614  76.219054   \n",
       "8   AN-X009        680.892009     333.038532   301.518475  83.855586   \n",
       "9   AN-X010        766.458062     211.583928   348.242415  68.124968   \n",
       "11  AN-X012        975.927882     278.977030   507.568559  62.353691   \n",
       "17  AN-X018        619.805145     299.256047   523.947422  65.198830   \n",
       "23  AN-X024        493.089475     238.041540   410.314741  68.398017   \n",
       "24  AN-X025        564.855987     332.348130   379.560710  88.645958   \n",
       "25  AN-X026        828.140769     491.686231   373.196893  82.136908   \n",
       "28  AN-X029        673.931655     155.561704   567.613967  72.588002   \n",
       "31  AN-X032        336.419299      98.305875   450.791128  82.735383   \n",
       "33  AN-X034        959.108430     420.092137   447.755308  63.482179   \n",
       "35  AN-X036        846.717878     408.562346   516.735635  61.221864   \n",
       "38  AN-X039        747.386421     440.903682   493.641689  74.225215   \n",
       "41  AN-X042        596.141528     351.425837   586.178573  74.204153   \n",
       "43  AN-X044        927.456322     390.702648   411.047610  73.015549   \n",
       "44  AN-X045        407.023985     113.361719   304.636985  71.955142   \n",
       "45  AN-X046        730.017827     179.509558   578.495569  78.475503   \n",
       "48  AN-X049        637.368223     191.183001   589.085993  71.238378   \n",
       "51  AN-X052        820.106259     341.649513   415.529319  85.694695   \n",
       "52  AN-X053        951.599153     265.915898   555.341001  79.760809   \n",
       "53  AN-X054        915.861880     541.562208   395.076602  64.888033   \n",
       "54  AN-X055        678.319983     281.556109   350.847824  62.117062   \n",
       "55  AN-X056        937.499388     343.644217   467.040379  79.272578   \n",
       "64  AN-X065        424.747608     222.231816   563.211922  88.243944   \n",
       "66  AN-X067        312.739380     121.987216   509.104722  88.835717   \n",
       "67  AN-X068        841.757585     299.214808   510.745225  87.160519   \n",
       "69  AN-X070        989.509549     622.714355   388.077553  62.080839   \n",
       "71  AN-X072        358.972545     163.270263   543.034018  60.546655   \n",
       "73  AN-X074        852.369143      99.358986   573.972166  80.490203   \n",
       "75  AN-X076        783.205734     289.493143   450.454888  69.569269   \n",
       "80  AN-X081        890.482741     422.853081   567.001603  63.544945   \n",
       "81  AN-X082        698.638501     240.778817   401.398547  80.902115   \n",
       "88  AN-X089        909.770194     573.720463   385.962376  82.518443   \n",
       "89  AN-X090        577.771940     343.481833   477.249978  84.205042   \n",
       "94  AN-X095        816.773744     421.223833   338.118154  70.224106   \n",
       "\n",
       "    eficiencia  \n",
       "0    35.054463  \n",
       "1    68.618355  \n",
       "2    51.105812  \n",
       "8    48.912093  \n",
       "9    27.605415  \n",
       "11   28.585824  \n",
       "17   48.282279  \n",
       "23   48.275526  \n",
       "24   58.837675  \n",
       "25   59.372301  \n",
       "28   23.082712  \n",
       "31   29.221235  \n",
       "33   43.800276  \n",
       "35   48.252477  \n",
       "38   58.992734  \n",
       "41   58.950068  \n",
       "43   42.126259  \n",
       "44   27.851361  \n",
       "45   24.589750  \n",
       "48   29.995691  \n",
       "51   41.659176  \n",
       "52   27.944108  \n",
       "53   59.131428  \n",
       "54   41.507860  \n",
       "55   36.655407  \n",
       "64   52.320911  \n",
       "66   39.006030  \n",
       "67   35.546434  \n",
       "69   62.931616  \n",
       "71   45.482660  \n",
       "73   11.656802  \n",
       "75   36.962592  \n",
       "80   47.485826  \n",
       "81   34.464006  \n",
       "88   63.062130  \n",
       "89   59.449379  \n",
       "94   51.571667  "
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#PROCESO\n",
    "#Nos aseguramos de que ambas columnas sean números. Si son texto (strings), el cálculo fallará.\n",
    "df['prod_real_bpd'] = pd.to_numeric(df['prod_real_bpd'], errors='coerce')\n",
    "df['prod_teorica_bpd'] = pd.to_numeric(df['prod_teorica_bpd'], errors='coerce')\n",
    "\n",
    "#Evitamos una indeterminacion\n",
    "df['eficiencia'] = (df['prod_real_bpd'] / df['prod_teorica_bpd'].replace(0, np.nan)) * 100\n",
    "\n",
    "#Utilizamos el metodo .query() para filtrar. \n",
    "prioridad_intervencion = df.query('eficiencia < 70')\n",
    "prioridad_intervencion\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5ca5ad8f-e8e3-4fc0-b264-000bcb743439",
   "metadata": {},
   "source": [
    "#### Ahora vamos a cuantificar el impacto económico.\n",
    "\n",
    "1. Necesitamos saber cuántos barriles estamos dejando de ganar por esa ineficiencia.\n",
    "\n",
    "2. **Calculamos la pérdida**: Creamos una columna *barriles_perdidos* que es la diferencia de lo teorico a lo real\n",
    "\n",
    "3. **Impacto Total**: Son todos los barriles perdidos de la lista de la prioridad a intervenir.\n",
    "\n",
    "4. Se estima que en Vaca Muerta, el barril está rondando los **75 USD**."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "973fe835-52ce-4b42-b1aa-6fecb5a2f22f",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "⚠️ La pérdida total acumulada por baja eficiencia es: 1127378.40 USD\n"
     ]
    }
   ],
   "source": [
    "#Modelo 1\n",
    "# 1. Calculas la pérdida para todos\n",
    "    #df['barriles_perdidos'] = df['prod_teorica_bpd'] - df['prod_real_bpd']\n",
    "# 2. Filtras para mostrar solo los de baja eficiencia con su nueva columna\n",
    "    #prioridad_intervencion = df[df['eficiencia'] < 50]\n",
    "#3. Sumamos todas las perdidas\n",
    "    #total_perdido = prioridad_intervencion['barriles_perdidos'].sum()\n",
    "\n",
    "\n",
    "#Modelo 2\n",
    "# Calculamos la pérdida solo para los que tienen < 70% de eficiencia\n",
    "prioridad_intervencion = df[df['eficiencia'] < 70].copy() \n",
    "# Filtras para mostrar solo los de baja eficiencia con su nueva columna\n",
    "prioridad_intervencion['barriles_perdidos'] = prioridad_intervencion['prod_teorica_bpd'] - prioridad_intervencion['prod_real_bpd']\n",
    "\n",
    "#Calculamos el impacto total de estas pérdidas\n",
    "impacto_total = prioridad_intervencion['barriles_perdidos'].sum()\n",
    "valor_perdida=impacto_total*75\n",
    "\n",
    "print(f\"⚠️ La pérdida total acumulada por baja eficiencia es: {valor_perdida:.2f} USD\")\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ed94ea48-ce56-41b5-892b-c661c76e6725",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.13.9"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
